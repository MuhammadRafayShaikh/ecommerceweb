@{
    Layout = null;
}
@model E_Commerce.Models.ViewModels.ResetPasswordViewModel

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forgot Password | Elegant Suits Boutique</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Poppins:wght@300;400;500;600&display=swap">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="~/auth/forgot-password.css" />
    <link rel="stylesheet" href="~/user/notification/notification.css" />
</head>

<body>
    <div class="forgot-password-container">
        <!-- Left Panel with Branding -->
        <div class="left-panel">
            <div class="logo">Elegant<span>Suits</span></div>
            <p class="tagline">Reset your password and get back to exploring our exclusive collection of premium suits.</p>

            <div class="security-info">
                <div class="security-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h3>Security Guaranteed</h3>
                <p>We use industry-standard encryption to protect your password reset process.</p>
            </div>

            <ul class="features">
                <li><i class="fas fa-envelope"></i> Reset link sent to registered email</li>
                <li><i class="fas fa-clock"></i> Link valid for 24 hours</li>
                <li><i class="fas fa-mobile-alt"></i> One-time use only</li>
                <li><i class="fas fa-lock"></i> 256-bit SSL encryption</li>
            </ul>
        </div>

        <!-- Right Panel with Form -->
        <div class="right-panel">
            <div class="form-container">
                <!-- Progress Steps -->
                <div class="progress-steps">
                    <div class="step active" data-step="1">
                        <div class="step-number">1</div>
                        <span class="step-label">Enter Email</span>
                    </div>
                    <div class="step" data-step="2">
                        <div class="step-number">2</div>
                        <span class="step-label">Verify Email</span>
                    </div>
                    <div class="step" data-step="3">
                        <div class="step-number">3</div>
                        <span class="step-label">New Password</span>
                    </div>
                    <div class="step" data-step="4">
                        <div class="step-number">4</div>
                        <span class="step-label">Complete</span>
                    </div>
                </div>

                <!-- Step 1: Enter Email -->
                <div class="form-step active" id="step1">
                    <div class="form-header">
                        <h1>Forgot Password?</h1>
                        <p>Enter your email address and we'll send you a link to reset your password.</p>
                    </div>

                    <form id="forgotPasswordForm" asp-controller="Account" asp-action="ForgotPassword" method="post">
                        @Html.AntiForgeryToken()

                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <div class="input-with-icon">
                                <i class="fas fa-envelope"></i>
                                <input type="email" asp-for="Email" id="email" placeholder="Enter your registered email address" required>
                            </div>
                            <span asp-validation-for="Email" class="text-danger"></span>
                        </div>

                        <button type="submit" class="btn-primary" id="sendResetLinkBtn">
                            <span class="btn-text">Send Reset Link</span>
                            <i class="fas fa-paper-plane"></i>
                        </button>

                        <div class="back-to-login">
                            <i class="fas fa-arrow-left"></i>
                            <a asp-controller="Account" asp-action="Login">Back to Login</a>
                        </div>
                    </form>
                </div>

                <!-- Step 2: Check Email -->
                <div class="form-step" id="step2">
                    <div class="form-header">
                        <div class="success-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h1>Check Your Email</h1>
                        <p>We've sent a password reset link to <span id="sentEmail"></span></p>
                    </div>

                    <div class="email-instructions">
                        <div class="instruction-card">
                            <div class="instruction-icon">
                                <i class="fas fa-inbox"></i>
                            </div>
                            <h3>Check your inbox</h3>
                            <p>Look for an email from <strong>noreply@elegantsuits.com</strong></p>
                        </div>

                        <div class="instruction-card">
                            <div class="instruction-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <h3>Link expires in 24 hours</h3>
                            <p>For security, the reset link will expire after 24 hours</p>
                        </div>

                        <div class="instruction-card">
                            <div class="instruction-icon">
                                <i class="fas fa-spam"></i>
                            </div>
                            <h3>Check spam folder</h3>
                            <p>If you don't see the email, check your spam or junk folder</p>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button type="button" class="btn-secondary" id="resendLinkBtn">
                            <i class="fas fa-redo"></i>
                            Resend Link
                        </button>
                        <button type="button" class="btn-text" id="changeEmailBtn">
                            <i class="fas fa-edit"></i>
                            Change Email
                        </button>
                    </div>

                    <div class="email-help">
                        <p><i class="fas fa-question-circle"></i> Didn't receive the email? <a href="#" id="contactSupport">Contact Support</a></p>
                    </div>
                </div>

                <!-- Step 3: Reset Password -->
                <div class="form-step" id="step3">
                    <div class="form-header">
                        <h1>Reset Your Password</h1>
                        <p>Create a strong new password for your account</p>
                    </div>

                    <form id="resetPasswordForm" asp-controller="Account" asp-action="ResetPassword" method="post">
                        @Html.AntiForgeryToken()
                        <input type="hidden" asp-for="Email" id="resetEmail">
                        <input type="hidden" asp-for="Token" id="resetToken">

                        <div class="form-group">
                            <label for="newPassword">New Password</label>
                            <div class="input-with-icon password-container">
                                <i class="fas fa-lock"></i>
                                <input type="password" asp-for="NewPassword" id="newPassword" placeholder="Create a strong password" required>
                                <button type="button" class="toggle-password">
                                    <i class="far fa-eye"></i>
                                </button>
                            </div>
                            <div class="password-strength">
                                <div class="strength-bar">
                                    <div class="strength-fill" id="strengthFill"></div>
                                </div>
                                <span class="strength-text" id="strengthText">Weak</span>
                            </div>
                            <div class="password-requirements">
                                <p class="requirement" data-requirement="length"><i class="fas fa-check"></i> At least 8 characters</p>
                                <p class="requirement" data-requirement="uppercase"><i class="fas fa-check"></i> One uppercase letter</p>
                                <p class="requirement" data-requirement="lowercase"><i class="fas fa-check"></i> One lowercase letter</p>
                                <p class="requirement" data-requirement="number"><i class="fas fa-check"></i> One number</p>
                                <p class="requirement" data-requirement="special"><i class="fas fa-check"></i> One special character</p>
                            </div>
                            <span asp-validation-for="NewPassword" class="text-danger"></span>
                        </div>

                        <div class="form-group">
                            <label for="confirmPassword">Confirm Password</label>
                            <div class="input-with-icon password-container">
                                <i class="fas fa-lock"></i>
                                <input type="password" asp-for="ConfirmPassword" id="confirmPassword" placeholder="Re-enter your new password" required>
                                <button type="button" class="toggle-password">
                                    <i class="far fa-eye"></i>
                                </button>
                            </div>
                            <div class="password-match" id="passwordMatch">
                                <i class="fas fa-check"></i> Passwords match
                            </div>
                            <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                        </div>

                        <button type="submit" class="btn-primary" id="resetPasswordBtn">
                            <span class="btn-text">Reset Password</span>
                            <i class="fas fa-key"></i>
                        </button>
                    </form>
                </div>

                <!-- Step 4: Success -->
                <div class="form-step" id="step4">
                    <div class="success-container">
                        <div class="success-animation">
                            <div class="success-circle">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="success-ripple"></div>
                        </div>

                        <h1>Password Reset Successful!</h1>
                        <p>Your password has been successfully updated. You can now login with your new password.</p>

                        <div class="success-actions">
                            <a asp-controller="Account" asp-action="Login" class="success-btn">
                                <i class="fas fa-sign-in-alt"></i>
                                Go to Login
                            </a>
                            <a asp-controller="Home" asp-action="Index" class="success-btn-secondary">
                                <i class="fas fa-home"></i>
                                Return to Home
                            </a>
                        </div>

                        <div class="security-tip">
                            <i class="fas fa-lightbulb"></i>
                            <p><strong>Security Tip:</strong> For better security, avoid reusing passwords across different websites.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Resend Timer Modal -->
    <div class="modal" id="resendModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-clock"></i> Resend Timer</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="timer-display">
                    <div class="timer-circle">
                        <svg width="120" height="120" viewBox="0 0 120 120">
                            <circle class="timer-bg" cx="60" cy="60" r="54" stroke-width="6"></circle>
                            <circle class="timer-progress" cx="60" cy="60" r="54" stroke-width="6"></circle>
                        </svg>
                        <div class="timer-text">
                            <span id="timerMinutes">05</span>:<span id="timerSeconds">00</span>
                        </div>
                    </div>
                    <p>You can request a new reset link in <span id="remainingTime">5 minutes</span></p>
                </div>
            </div>
        </div>
    </div>

    @await Html.PartialAsync("_Toast")
    <script src="~/auth/forgot-password.js"></script>
    <script src="~/user/notification/notification.js"></script>

    @if (TempData["SuccessMessage"] != null)
    {
        <script>
            showToast("@TempData["SuccessMessage"]", "success");
        </script>
    }
    @if (TempData["ErrorMessage"] != null)
    {
        <script>
            showToast("@TempData["ErrorMessage"]", "error");
        </script>
    }
</body>
</html>